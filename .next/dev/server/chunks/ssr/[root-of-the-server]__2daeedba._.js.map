{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, Suspense } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport Link from 'next/link'\nimport { Eye, EyeOff, Loader2, FileText } from 'lucide-react'\nimport { getSupabaseClient } from '@/lib/supabase/client'\n\nfunction LoginForm() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const callbackUrl = searchParams.get('callbackUrl') || '/dashboard'\n\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [showPassword, setShowPassword] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [loginError, setLoginError] = useState('')\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setLoading(true)\n    setLoginError('')\n\n    try {\n      const supabase = getSupabaseClient()\n\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      })\n\n      if (error) {\n        setLoginError(error.message || 'Invalid email or password')\n      } else if (data.user) {\n        // Check user role to determine redirect\n        const { data: userData } = await supabase\n          .from('users')\n          .select('role')\n          .eq('id', data.user.id)\n          .single()\n\n        const userRole = (userData as { role: string } | null)?.role\n\n        // Redirect based on role\n        if (userRole === 'parent') {\n          router.push('/parent')\n        } else if (userRole === 'student') {\n          router.push('/student')\n        } else {\n          router.push(callbackUrl)\n        }\n        router.refresh()\n      }\n    } catch {\n      setLoginError('An error occurred. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex\">\n      {/* Left Panel - Image Background */}\n      <div\n        className=\"hidden lg:block lg:w-[48%] bg-cover bg-center bg-no-repeat relative\"\n        style={{\n          backgroundImage: `url('https://images.unsplash.com/photo-1577896851231-70ef18881754?q=80&w=2070&auto=format&fit=crop')`,\n        }}\n      >\n        {/* Overlay with gradient */}\n        <div className=\"absolute inset-0 bg-gradient-to-br from-emerald-900/70 via-emerald-800/50 to-transparent\" />\n\n        {/* Content on image */}\n        <div className=\"absolute bottom-12 left-12 right-12 text-white\">\n          <h2 className=\"text-3xl font-bold mb-3\">School Management System</h2>\n          <p className=\"text-emerald-100 text-lg\">\n            Streamline your school operations with our comprehensive management platform.\n          </p>\n        </div>\n      </div>\n\n      {/* Right Panel - Login Form */}\n      <div className=\"w-full lg:w-[52%] flex items-center justify-center px-6 py-12 bg-white\">\n        <div className=\"w-full max-w-[400px]\">\n          {/* Icon */}\n          <div className=\"flex justify-center mb-8\">\n            <div className=\"w-16 h-16 bg-emerald-700 rounded-2xl flex items-center justify-center shadow-lg\">\n              <FileText className=\"h-8 w-8 text-white\" />\n            </div>\n          </div>\n\n          {/* Header */}\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-[28px] font-semibold text-gray-900\">Welcome back!</h1>\n            <p className=\"text-gray-500 mt-2 text-[15px]\">Sign in to continue to your account</p>\n          </div>\n\n          {/* Form Card */}\n          <div className=\"bg-white border border-gray-200 rounded-xl p-6 shadow-sm\">\n            <form onSubmit={handleSubmit} className=\"space-y-5\">\n              {loginError && (\n                <div className=\"p-3 rounded-lg bg-red-50 border border-red-200\">\n                  <p className=\"text-sm text-red-600\">{loginError}</p>\n                </div>\n              )}\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1.5\">Email</label>\n                <input\n                  type=\"email\"\n                  placeholder=\"name@example.com\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                  autoComplete=\"email\"\n                  className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 transition-all outline-none text-gray-900 placeholder:text-gray-400 text-[15px]\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1.5\">Password</label>\n                <div className=\"relative\">\n                  <input\n                    type={showPassword ? 'text' : 'password'}\n                    placeholder=\"Enter your password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    required\n                    autoComplete=\"current-password\"\n                    className=\"w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 transition-all outline-none text-gray-900 placeholder:text-gray-400 text-[15px]\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1\"\n                  >\n                    {showPassword ? (\n                      <EyeOff className=\"h-5 w-5\" />\n                    ) : (\n                      <Eye className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full py-3 px-4 bg-emerald-700 hover:bg-emerald-800 text-white font-medium rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed text-[15px]\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"h-5 w-5 animate-spin\" />\n                    Signing in...\n                  </>\n                ) : (\n                  'Login'\n                )}\n              </button>\n            </form>\n\n            <div className=\"mt-5 text-center\">\n              <Link\n                href=\"/forgot-password\"\n                className=\"text-emerald-700 hover:text-emerald-800 font-medium text-[15px] transition-colors\"\n              >\n                Forgot Password?\n              </Link>\n            </div>\n          </div>\n\n          {/* Sign up link */}\n          <div className=\"mt-8 text-center\">\n            <p className=\"text-gray-600 text-[15px]\">\n              Don&apos;t have an account?{' '}\n              <Link\n                href=\"/signup\"\n                className=\"text-emerald-700 hover:text-emerald-800 font-medium transition-colors\"\n              >\n                Sign up\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction LoginLoading() {\n  return (\n    <div className=\"min-h-screen bg-white flex items-center justify-center\">\n      <Loader2 className=\"h-10 w-10 animate-spin text-emerald-700\" />\n    </div>\n  )\n}\n\nexport default function LoginPage() {\n  return (\n    <Suspense fallback={<LoginLoading />}>\n      <LoginForm />\n    </Suspense>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}