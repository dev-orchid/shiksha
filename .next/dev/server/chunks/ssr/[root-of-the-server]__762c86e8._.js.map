{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/lib/supabase/admin.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\n// Admin client with service role key - use only on server-side\n// Using generic client until types are properly generated\nexport function createAdminClient() {\n  return createClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false\n      }\n    }\n  )\n}\n"],"names":[],"mappings":";;;;AAAA;;AAIO,SAAS;IACd,OAAO,IAAA,8LAAY,gFAEjB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AAEJ"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/lib/supabase/auth-utils.ts"],"sourcesContent":["import { createClient } from './server'\nimport { createAdminClient } from './admin'\n\nexport interface AuthenticatedUser {\n  userId: string\n  schoolId: string | null  // Can be null for super_admin\n  email: string\n  role?: string\n}\n\n/**\n * Get the authenticated user's school_id from the session.\n * This should be used in API routes to enforce multi-tenant isolation.\n *\n * Returns the user info with their school_id, or null if not authenticated.\n * Note: super_admin users will have schoolId = null\n */\nexport async function getAuthenticatedUserSchool(): Promise<AuthenticatedUser | null> {\n  try {\n    const supabase = await createClient()\n\n    // Get the authenticated user from session\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n\n    if (authError || !user) {\n      return null\n    }\n\n    // Look up the user record to get the school_id and role\n    const adminClient = createAdminClient()\n    const { data: userData, error: userError } = await adminClient\n      .from('users')\n      .select('school_id, role')\n      .eq('id', user.id)\n      .single()\n\n    // Check if user is super_admin\n    if (userData?.role === 'super_admin') {\n      return {\n        userId: user.id,\n        schoolId: null, // Super admin has no school restriction\n        email: user.email || '',\n        role: 'super_admin'\n      }\n    }\n\n    // For regular users, get school_id\n    const metadataSchoolId = user.user_metadata?.school_id\n    const schoolId = userData?.school_id || metadataSchoolId\n\n    if (!schoolId) {\n      console.error('User has no associated school_id:', user.id)\n      return null\n    }\n\n    return {\n      userId: user.id,\n      schoolId,\n      email: user.email || '',\n      role: userData?.role\n    }\n  } catch (error) {\n    console.error('Error getting authenticated user school:', error)\n    return null\n  }\n}\n\n/**\n * Helper to require authentication and return school_id.\n * Throws an error response if not authenticated.\n */\nexport async function requireAuthenticatedSchool(): Promise<AuthenticatedUser> {\n  const authUser = await getAuthenticatedUserSchool()\n\n  if (!authUser) {\n    throw new Error('Unauthorized: User not authenticated or has no associated school')\n  }\n\n  return authUser\n}\n\n/**\n * Check if the authenticated user is a super admin.\n * Super admins have no school_id restriction and can access all schools.\n */\nexport async function isSuperAdmin(): Promise<boolean> {\n  const authUser = await getAuthenticatedUserSchool()\n  return authUser?.role === 'super_admin' && authUser?.schoolId === null\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAgBO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,gJAAY;QAEnC,0CAA0C;QAC1C,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAExE,IAAI,aAAa,CAAC,MAAM;YACtB,OAAO;QACT;QAEA,wDAAwD;QACxD,MAAM,cAAc,IAAA,oJAAiB;QACrC,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,YAChD,IAAI,CAAC,SACL,MAAM,CAAC,mBACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;QAET,+BAA+B;QAC/B,IAAI,UAAU,SAAS,eAAe;YACpC,OAAO;gBACL,QAAQ,KAAK,EAAE;gBACf,UAAU;gBACV,OAAO,KAAK,KAAK,IAAI;gBACrB,MAAM;YACR;QACF;QAEA,mCAAmC;QACnC,MAAM,mBAAmB,KAAK,aAAa,EAAE;QAC7C,MAAM,WAAW,UAAU,aAAa;QAExC,IAAI,CAAC,UAAU;YACb,QAAQ,KAAK,CAAC,qCAAqC,KAAK,EAAE;YAC1D,OAAO;QACT;QAEA,OAAO;YACL,QAAQ,KAAK,EAAE;YACf;YACA,OAAO,KAAK,KAAK,IAAI;YACrB,MAAM,UAAU;QAClB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4CAA4C;QAC1D,OAAO;IACT;AACF;AAMO,eAAe;IACpB,MAAM,WAAW,MAAM;IAEvB,IAAI,CAAC,UAAU;QACb,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;AAMO,eAAe;IACpB,MAAM,WAAW,MAAM;IACvB,OAAO,UAAU,SAAS,iBAAiB,UAAU,aAAa;AACpE"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/components/ui/Card.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const Card = registerClientReference(\n    function() { throw new Error(\"Attempted to call Card() from the server but Card is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx <module evaluation>\",\n    \"Card\",\n);\nexport const CardContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardContent() from the server but CardContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx <module evaluation>\",\n    \"CardContent\",\n);\nexport const CardDescription = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardDescription() from the server but CardDescription is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx <module evaluation>\",\n    \"CardDescription\",\n);\nexport const CardFooter = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardFooter() from the server but CardFooter is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx <module evaluation>\",\n    \"CardFooter\",\n);\nexport const CardHeader = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardHeader() from the server but CardHeader is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx <module evaluation>\",\n    \"CardHeader\",\n);\nexport const CardTitle = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardTitle() from the server but CardTitle is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx <module evaluation>\",\n    \"CardTitle\",\n);\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,OAAO,IAAA,wQAAuB,EACvC;IAAa,MAAM,IAAI,MAAM;AAAwN,GACrP,4DACA;AAEG,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,4DACA;AAEG,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,4DACA;AAEG,MAAM,aAAa,IAAA,wQAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,4DACA;AAEG,MAAM,aAAa,IAAA,wQAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,4DACA;AAEG,MAAM,YAAY,IAAA,wQAAuB,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,4DACA","ignoreList":[0]}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/components/ui/Card.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const Card = registerClientReference(\n    function() { throw new Error(\"Attempted to call Card() from the server but Card is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx\",\n    \"Card\",\n);\nexport const CardContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardContent() from the server but CardContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx\",\n    \"CardContent\",\n);\nexport const CardDescription = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardDescription() from the server but CardDescription is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx\",\n    \"CardDescription\",\n);\nexport const CardFooter = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardFooter() from the server but CardFooter is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx\",\n    \"CardFooter\",\n);\nexport const CardHeader = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardHeader() from the server but CardHeader is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx\",\n    \"CardHeader\",\n);\nexport const CardTitle = registerClientReference(\n    function() { throw new Error(\"Attempted to call CardTitle() from the server but CardTitle is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/Card.tsx\",\n    \"CardTitle\",\n);\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,OAAO,IAAA,wQAAuB,EACvC;IAAa,MAAM,IAAI,MAAM;AAAwN,GACrP,wCACA;AAEG,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,wCACA;AAEG,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,wCACA;AAEG,MAAM,aAAa,IAAA,wQAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,wCACA;AAEG,MAAM,aAAa,IAAA,wQAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,wCACA;AAEG,MAAM,YAAY,IAAA,wQAAuB,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,wCACA","ignoreList":[0]}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/app/%28dashboard%29/dashboard/page.tsx"],"sourcesContent":["import { createClient } from '@/lib/supabase/server'\nimport { getAuthenticatedUserSchool } from '@/lib/supabase/auth-utils'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/Card'\nimport {\n  Users,\n  GraduationCap,\n  IndianRupee,\n  UserCheck,\n  TrendingUp,\n  TrendingDown,\n  Calendar,\n} from 'lucide-react'\nimport { redirect } from 'next/navigation'\n\nexport const metadata = {\n  title: 'Dashboard | School Management System',\n}\n\nasync function getDashboardStats(schoolId: string) {\n  const supabase = await createClient()\n  const today = new Date().toISOString().split('T')[0]\n  const currentMonth = new Date()\n  const firstDayOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1).toISOString().split('T')[0]\n  const lastDayOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0).toISOString().split('T')[0]\n\n  // Previous month for comparison\n  const prevMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1, 1)\n  const firstDayPrevMonth = new Date(prevMonth.getFullYear(), prevMonth.getMonth(), 1).toISOString().split('T')[0]\n  const lastDayPrevMonth = new Date(prevMonth.getFullYear(), prevMonth.getMonth() + 1, 0).toISOString().split('T')[0]\n\n  // Fetch all stats in parallel - filtered by school_id for multi-tenancy\n  const [\n    studentsResult,\n    prevStudentsResult,\n    teachersResult,\n    prevTeachersResult,\n    paymentsResult,\n    prevPaymentsResult,\n    todayAttendanceResult,\n    totalStudentsForAttendance,\n    recentActivityResult,\n    upcomingEventsResult,\n  ] = await Promise.all([\n    // Current students count\n    supabase.from('students').select('id', { count: 'exact', head: true }).eq('school_id', schoolId).eq('status', 'active'),\n    // Previous month students (approximate by created_at)\n    supabase.from('students').select('id', { count: 'exact', head: true }).eq('school_id', schoolId).eq('status', 'active').lt('created_at', firstDayOfMonth),\n    // Current teachers count\n    supabase.from('staff').select('id', { count: 'exact', head: true }).eq('school_id', schoolId).eq('employee_type', 'teaching').eq('status', 'active'),\n    // Previous month teachers\n    supabase.from('staff').select('id', { count: 'exact', head: true }).eq('school_id', schoolId).eq('employee_type', 'teaching').eq('status', 'active').lt('created_at', firstDayOfMonth),\n    // This month's fee collection\n    supabase.from('fee_payments').select('amount, fee_invoices!inner(students!inner(school_id))').eq('fee_invoices.students.school_id', schoolId).gte('payment_date', firstDayOfMonth).lte('payment_date', lastDayOfMonth),\n    // Previous month's fee collection\n    supabase.from('fee_payments').select('amount, fee_invoices!inner(students!inner(school_id))').eq('fee_invoices.students.school_id', schoolId).gte('payment_date', firstDayPrevMonth).lte('payment_date', lastDayPrevMonth),\n    // Today's attendance (present students)\n    supabase.from('student_attendance').select('id, students!inner(school_id)', { count: 'exact', head: true }).eq('students.school_id', schoolId).eq('date', today).in('status', ['present', 'late']),\n    // Total students for attendance calculation\n    supabase.from('students').select('id', { count: 'exact', head: true }).eq('school_id', schoolId).eq('status', 'active'),\n    // Recent activity - last 5 fee payments for this school\n    supabase.from('fee_payments').select(`\n      id,\n      amount,\n      payment_date,\n      created_at,\n      fee_invoices!inner (\n        students!inner (\n          first_name,\n          last_name,\n          school_id\n        )\n      )\n    `).eq('fee_invoices.students.school_id', schoolId).order('created_at', { ascending: false }).limit(5),\n    // Upcoming events for this school\n    supabase.from('events').select(`\n      id,\n      title,\n      start_date,\n      event_types (id, name, color)\n    `).eq('school_id', schoolId).eq('is_active', true).gte('start_date', today).order('start_date', { ascending: true }).limit(6),\n  ])\n\n  // Calculate values\n  const totalStudents = studentsResult.count || 0\n  const prevTotalStudents = prevStudentsResult.count || 0\n  const studentChange = prevTotalStudents > 0\n    ? Math.round(((totalStudents - prevTotalStudents) / prevTotalStudents) * 100)\n    : 0\n\n  const totalTeachers = teachersResult.count || 0\n  const prevTotalTeachers = prevTeachersResult.count || 0\n  const teacherChange = prevTotalTeachers > 0\n    ? Math.round(((totalTeachers - prevTotalTeachers) / prevTotalTeachers) * 100)\n    : 0\n\n  const thisMonthCollection = (paymentsResult.data as { amount: number }[] | null)?.reduce((sum, p) => sum + (p.amount || 0), 0) || 0\n  const prevMonthCollection = (prevPaymentsResult.data as { amount: number }[] | null)?.reduce((sum, p) => sum + (p.amount || 0), 0) || 0\n  const feeChange = prevMonthCollection > 0\n    ? Math.round(((thisMonthCollection - prevMonthCollection) / prevMonthCollection) * 100)\n    : 0\n\n  const presentToday = todayAttendanceResult.count || 0\n  const totalForAttendance = totalStudentsForAttendance.count || 1\n  const attendancePercentage = totalForAttendance > 0\n    ? Math.round((presentToday / totalForAttendance) * 100)\n    : 0\n\n  return {\n    totalStudents,\n    studentChange,\n    totalTeachers,\n    teacherChange,\n    thisMonthCollection,\n    feeChange,\n    attendancePercentage,\n    recentActivity: recentActivityResult.data || [],\n    upcomingEvents: upcomingEventsResult.data || [],\n  }\n}\n\nfunction formatCurrency(amount: number): string {\n  if (amount >= 10000000) {\n    return `₹${(amount / 10000000).toFixed(2)}Cr`\n  } else if (amount >= 100000) {\n    return `₹${(amount / 100000).toFixed(2)}L`\n  } else if (amount >= 1000) {\n    return `₹${(amount / 1000).toFixed(2)}K`\n  }\n  return `₹${amount.toLocaleString('en-IN')}`\n}\n\nfunction getTimeAgo(date: Date): string {\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffMins = Math.floor(diffMs / 60000)\n  const diffHours = Math.floor(diffMs / 3600000)\n  const diffDays = Math.floor(diffMs / 86400000)\n\n  if (diffMins < 1) return 'Just now'\n  if (diffMins < 60) return `${diffMins} min${diffMins > 1 ? 's' : ''} ago`\n  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`\n  if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`\n  return date.toLocaleDateString('en-IN')\n}\n\nexport default async function DashboardPage() {\n  const authUser = await getAuthenticatedUserSchool()\n\n  if (!authUser) {\n    redirect('/auth/login')\n  }\n\n  const supabase = await createClient()\n  const { data: { user } } = await supabase.auth.getUser()\n\n  // Get display name from user metadata, fall back to email prefix\n  const displayName = user?.user_metadata?.display_name\n    || user?.user_metadata?.full_name\n    || user?.user_metadata?.name\n    || user?.email?.split('@')[0]\n    || 'User'\n\n  const dashboardData = await getDashboardStats(authUser.schoolId)\n\n  const stats = [\n    {\n      title: 'Total Students',\n      value: dashboardData.totalStudents.toLocaleString('en-IN'),\n      change: dashboardData.studentChange,\n      icon: Users,\n      color: 'bg-blue-500',\n    },\n    {\n      title: 'Total Teachers',\n      value: dashboardData.totalTeachers.toString(),\n      change: dashboardData.teacherChange,\n      icon: GraduationCap,\n      color: 'bg-green-500',\n    },\n    {\n      title: 'Fee Collection',\n      value: formatCurrency(dashboardData.thisMonthCollection),\n      change: dashboardData.feeChange,\n      icon: IndianRupee,\n      color: 'bg-yellow-500',\n    },\n    {\n      title: 'Today\\'s Attendance',\n      value: `${dashboardData.attendancePercentage}%`,\n      change: 0,\n      icon: UserCheck,\n      color: 'bg-purple-500',\n    },\n  ]\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Welcome message */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-gray-900\">\n          Welcome back, {displayName}!\n        </h1>\n        <p className=\"text-gray-500 mt-1\">\n          Here&apos;s what&apos;s happening at your school today.\n        </p>\n      </div>\n\n      {/* Stats grid */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-500\">{stat.title}</p>\n                  <p className=\"text-2xl font-bold text-gray-900 mt-1\">\n                    {stat.value}\n                  </p>\n                  {stat.change !== 0 && (\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      {stat.change > 0 ? (\n                        <TrendingUp className=\"h-3 w-3 text-green-500\" />\n                      ) : (\n                        <TrendingDown className=\"h-3 w-3 text-red-500\" />\n                      )}\n                      <span className={`text-xs ${stat.change > 0 ? 'text-green-600' : 'text-red-600'}`}>\n                        {stat.change > 0 ? '+' : ''}{stat.change}%\n                      </span>\n                      <span className=\"text-xs text-gray-500\">vs last month</span>\n                    </div>\n                  )}\n                </div>\n                <div className={`p-3 rounded-lg ${stat.color}`}>\n                  <stat.icon className=\"h-6 w-6 text-white\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Quick actions and recent activity */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Quick Actions */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Quick Actions</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <a\n                href=\"/attendance/students\"\n                className=\"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors\"\n              >\n                <UserCheck className=\"h-5 w-5 text-primary\" />\n                <span className=\"text-sm font-medium\">Mark Attendance</span>\n              </a>\n              <a\n                href=\"/fees\"\n                className=\"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors\"\n              >\n                <IndianRupee className=\"h-5 w-5 text-primary\" />\n                <span className=\"text-sm font-medium\">Collect Fees</span>\n              </a>\n              <a\n                href=\"/students/new\"\n                className=\"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors\"\n              >\n                <Users className=\"h-5 w-5 text-primary\" />\n                <span className=\"text-sm font-medium\">Add Student</span>\n              </a>\n              <a\n                href=\"/whatsapp/send\"\n                className=\"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors\"\n              >\n                <Calendar className=\"h-5 w-5 text-primary\" />\n                <span className=\"text-sm font-medium\">Send Notice</span>\n              </a>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Recent Activity */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Activity</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {dashboardData.recentActivity.length > 0 ? (\n                dashboardData.recentActivity.map((activity: any) => {\n                  const studentName = activity.fee_invoices?.students\n                    ? `${activity.fee_invoices.students.first_name} ${activity.fee_invoices.students.last_name}`\n                    : 'Unknown'\n                  const timeAgo = getTimeAgo(new Date(activity.created_at))\n                  return (\n                    <div\n                      key={activity.id}\n                      className=\"flex items-center justify-between py-2 border-b border-gray-100 last:border-0\"\n                    >\n                      <div>\n                        <p className=\"text-sm font-medium text-gray-900\">\n                          Fee payment: {formatCurrency(activity.amount)}\n                        </p>\n                        <p className=\"text-xs text-gray-500\">from {studentName}</p>\n                      </div>\n                      <span className=\"text-xs text-gray-400\">{timeAgo}</span>\n                    </div>\n                  )\n                })\n              ) : (\n                <p className=\"text-sm text-gray-500 text-center py-4\">No recent activity</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Upcoming Events */}\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between\">\n          <CardTitle>Upcoming Events</CardTitle>\n          <a href=\"/events\" className=\"text-sm text-primary hover:underline\">\n            View all\n          </a>\n        </CardHeader>\n        <CardContent>\n          {dashboardData.upcomingEvents.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              {dashboardData.upcomingEvents.map((event: any) => (\n                <a\n                  key={event.id}\n                  href={`/events/${event.id}/edit`}\n                  className=\"p-4 rounded-lg border border-gray-200 hover:border-primary/50 transition-colors\"\n                >\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <Calendar className=\"h-4 w-4 text-primary\" />\n                    <span\n                      className=\"text-xs font-medium px-2 py-0.5 rounded\"\n                      style={{\n                        backgroundColor: event.event_types?.color || '#3b82f6',\n                        color: 'white',\n                      }}\n                    >\n                      {event.event_types?.name || 'Event'}\n                    </span>\n                  </div>\n                  <h4 className=\"font-medium text-gray-900\">{event.title}</h4>\n                  <p className=\"text-sm text-gray-500 mt-1\">\n                    {new Date(event.start_date).toLocaleDateString('en-IN', {\n                      day: 'numeric',\n                      month: 'short',\n                      year: 'numeric',\n                    })}\n                  </p>\n                </a>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8\">\n              <Calendar className=\"h-12 w-12 text-gray-300 mx-auto mb-3\" />\n              <p className=\"text-sm text-gray-500\">No upcoming events</p>\n              <a\n                href=\"/events/new\"\n                className=\"text-sm text-primary hover:underline mt-2 inline-block\"\n              >\n                Create your first event\n              </a>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}