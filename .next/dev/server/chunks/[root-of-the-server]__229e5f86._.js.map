{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/lib/supabase/middleware.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { NextResponse, type NextRequest } from 'next/server'\n\nexport async function updateSession(request: NextRequest) {\n  let supabaseResponse = NextResponse.next({\n    request,\n  })\n\n  // Check if Supabase credentials are configured\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n  if (!supabaseUrl || !supabaseAnonKey) {\n    // Return null user if Supabase is not configured\n    return { user: null, supabaseResponse }\n  }\n\n  const supabase = createServerClient(\n    supabaseUrl,\n    supabaseAnonKey,\n    {\n      cookies: {\n        getAll() {\n          return request.cookies.getAll()\n        },\n        setAll(cookiesToSet) {\n          cookiesToSet.forEach(({ name, value }) => request.cookies.set(name, value))\n          supabaseResponse = NextResponse.next({\n            request,\n          })\n          cookiesToSet.forEach(({ name, value, options }) =>\n            supabaseResponse.cookies.set(name, value, options)\n          )\n        },\n      },\n    }\n  )\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  return { user, supabaseResponse }\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe,cAAc,OAAoB;IACtD,IAAI,mBAAmB,8IAAY,CAAC,IAAI,CAAC;QACvC;IACF;IAEA,+CAA+C;IAC/C,MAAM;IACN,MAAM;IAEN;;IAKA,MAAM,WAAW,IAAA,+LAAkB,EACjC,aACA,iBACA;QACE,SAAS;YACP;gBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;YAC/B;YACA,QAAO,YAAY;gBACjB,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,GAAK,QAAQ,OAAO,CAAC,GAAG,CAAC,MAAM;gBACpE,mBAAmB,8IAAY,CAAC,IAAI,CAAC;oBACnC;gBACF;gBACA,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,iBAAiB,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;YAE9C;QACF;IACF;IAGF,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,OAAO;QAAE;QAAM;IAAiB;AAClC"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///Applications/Projects/school/shiksha-sms/src/proxy.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\nimport { updateSession } from '@/lib/supabase/middleware'\n\nexport async function proxy(request: NextRequest) {\n  const { pathname } = request.nextUrl\n\n  // Public routes that don't need authentication\n  const publicRoutes = ['/', '/login', '/signup', '/forgot-password', '/reset-password']\n  const isPublicRoute = publicRoutes.some(route => pathname === route || pathname.startsWith(route))\n\n  // Static files and API routes\n  const isApiRoute = pathname.startsWith('/api')\n\n  // Skip middleware for public routes\n  if (isPublicRoute) {\n    return NextResponse.next()\n  }\n\n  // Update session and get user\n  const { user, supabaseResponse } = await updateSession(request)\n\n  // If no user and trying to access protected route, redirect to login\n  if (!user && !isApiRoute) {\n    const loginUrl = new URL('/login', request.url)\n    loginUrl.searchParams.set('callbackUrl', pathname)\n    return NextResponse.redirect(loginUrl)\n  }\n\n  // If authenticated and trying to access login, redirect to dashboard\n  if (user && pathname === '/login') {\n    return NextResponse.redirect(new URL('/dashboard', request.url))\n  }\n\n  return supabaseResponse\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder\n     */\n    '/((?!_next/static|_next/image|favicon.ico|public/).*)',\n  ],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA;;;AAEO,eAAe,MAAM,OAAoB;IAC9C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,+CAA+C;IAC/C,MAAM,eAAe;QAAC;QAAK;QAAU;QAAW;QAAoB;KAAkB;IACtF,MAAM,gBAAgB,aAAa,IAAI,CAAC,CAAA,QAAS,aAAa,SAAS,SAAS,UAAU,CAAC;IAE3F,8BAA8B;IAC9B,MAAM,aAAa,SAAS,UAAU,CAAC;IAEvC,oCAAoC;IACpC,IAAI,eAAe;QACjB,OAAO,8IAAY,CAAC,IAAI;IAC1B;IAEA,8BAA8B;IAC9B,MAAM,EAAE,IAAI,EAAE,gBAAgB,EAAE,GAAG,MAAM,IAAA,qJAAa,EAAC;IAEvD,qEAAqE;IACrE,IAAI,CAAC,QAAQ,CAAC,YAAY;QACxB,MAAM,WAAW,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9C,SAAS,YAAY,CAAC,GAAG,CAAC,eAAe;QACzC,OAAO,8IAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,qEAAqE;IACrE,IAAI,QAAQ,aAAa,UAAU;QACjC,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;IAChE;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}